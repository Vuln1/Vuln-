#!/usr/bin/env python3
import requests
import os
from multiprocessing.dummy import Pool
from colorama import Fore, Style, init

init(autoreset=True)

fg = Fore.GREEN
fr = Fore.RED
fc = Fore.CYAN
fw = Fore.WHITE
sb = Style.BRIGHT

THREADS = 25  # عدد الثريدات لزيادة سرعة الفحص
FILE_NAME = "common.txt"
REPORT = "report.txt"

# ---------------------- BANNER --------------------------
def banner():
    print(f"""{fc}{sb}
╔════════════════════════════════════════════╗
║         WordPress Advanced Scanner        ║
║               Fast • Safe • Clean         ║
║                Powered by YHIA            ║
╚════════════════════════════════════════════╝
""")

banner()

# ------------------- READ PATHS -------------------------
if not os.path.exists(FILE_NAME):
    print(f"{fr}[خطأ] ملف {FILE_NAME} غير موجود! ضعه بجانب السكربت.")
    exit()

with open(FILE_NAME, "r", encoding="utf-8", errors="ignore") as f:
    paths = [line.strip() for line in f if line.strip()]

print(f"{fc}[+] Loaded {len(paths)} paths from {FILE_NAME}\n")
open(REPORT, "w").write("=== Scan Report ===\n")

# ------------------- CHECK FUNCTION ---------------------
def scan_path(p):
    url = TARGET

    if not p.startswith("/"):
        p = "/" + p

    full = url + p

    try:
        r = requests.get(full, timeout=6)
        code = r.status_code

        if code in [200, 201]:
            msg = f"OPEN ⚠  {full}"
            print(f"{fr}{msg}")
            open(REPORT, "a").write(msg + "\n")

        elif code == 403:
            msg = f"Forbidden ✔  {full}"
            print(f"{fg}{msg}")
            open(REPORT, "a").write(msg + "\n")

        elif code == 404:
            msg = f"Not Found ✔  {full}"
            print(f"{fg}{msg}")
            open(REPORT, "a").write(msg + "\n")

        else:
            msg = f"Unknown ({code}) • {full}"
            print(f"{fc}{msg}")
            open(REPORT, "a").write(msg + "\n")

    except:
        msg = f"Error ❌ {full}"
        print(f"{fr}{msg}")
        open(REPORT, "a").write(msg + "\n")

# ----------------------- MAIN ---------------------------
if __name__ == "__main__":
    TARGET = input("Enter your site URL (مثال: https://example.com): ").strip()
    if TARGET.endswith("/"):
        TARGET = TARGET[:-1]

    print(f"\n{fc}[+] Starting fast scan using {THREADS} threads...\n")

    pool = Pool(THREADS)
    pool.map(scan_path, paths)
    pool.close()
    pool.join()

    print(f"\n{fg}[✔] Done! Check your report: {REPORT}\n")
    # مبرمج عراقي ملقب في بلاند / Vuin حسابي تلي @rrrs_r
